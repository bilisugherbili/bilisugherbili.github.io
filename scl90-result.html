<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCL-90 测评报告 - 金织网</title>
    <style>
        :root {
            --primary-color: #D4AF37;
            --primary-dark: #B8860B;
            --primary-light: #F9F2D6;
            --secondary-color: #8B7355;
            --text-dark: #2D2926;
            --text-gray: #5C554E;
            --text-light: #8A817C;
            --bg-light: #FFFAF0;
            --bg-white: #ffffff;
            --border-gray: #E8E0D0;
            --shadow-sm: 0 2px 8px rgba(212, 175, 55, 0.15);
            --radius-sm: 6px;
            --radius-md: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Inter", "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--bg-white);
            box-shadow: var(--shadow-sm);
            padding: 15px 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .logo span {
            color: var(--primary-dark);
        }

        .result-header {
            background-color: var(--bg-white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            border: 1px solid var(--border-gray);
        }

        .result-header h2 {
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 24px;
        }

        .result-header p {
            color: var(--text-gray);
            font-size: 14px;
        }

        .result-summary {
            background-color: var(--bg-white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-gray);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .summary-card {
            background-color: var(--primary-light);
            padding: 20px;
            border-radius: var(--radius-sm);
            text-align: center;
            border: 1px solid var(--border-gray);
        }

        .summary-card h4 {
            color: var(--primary-dark);
            font-size: 14px;
            margin-bottom: 8px;
        }

        .summary-card .score {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .summary-card .desc {
            font-size: 12px;
            color: var(--text-gray);
            margin-top: 5px;
        }

        .dimensions-section {
            background-color: var(--bg-white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-gray);
        }

        .dimensions-section h3 {
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-size: 20px;
        }

        .dimension-item {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-gray);
        }

        .dimension-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .dimension-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .dimension-score {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .dimension-bar {
            width: 100%;
            height: 8px;
            background-color: var(--primary-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .dimension-fill {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .dimension-desc {
            font-size: 13px;
            color: var(--text-gray);
            line-height: 1.5;
        }

        .interpretation {
            background-color: var(--bg-white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-gray);
        }

        .interpretation h3 {
            color: var(--primary-dark);
            margin-bottom: 15px;
            font-size: 20px;
        }

        .interpretation p {
            color: var(--text-gray);
            font-size: 14px;
            line-height: 1.7;
            margin-bottom: 10px;
        }

        .actions {
            text-align: center;
            margin-bottom: 40px;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
            border: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            border: 1px solid var(--primary-dark);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--bg-white);
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background-color: var(--primary-light);
        }

        .warning-box {
            background-color: #FFF8E1;
            border: 1px solid #FFD54F;
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-top: 20px;
        }

        .warning-box p {
            font-size: 13px;
            color: #5D4037;
            margin: 0;
        }

        @media (max-width: 768px) {
            .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .dimension-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
                <i class="fas fa-hand-holding-heart"></i>
                <span>金</span>织网
            </a>
            <div>测评报告</div>
        </div>
    </header>

    <div class="container">
        <div class="result-header">
            <h2><i class="fas fa-chart-line"></i> SCL-90 心理健康测评报告</h2>
            <p>测评时间：<span id="testTime"></span> | 本报告仅供参考，不构成医学诊断</p>
        </div>

        <div class="result-summary">
            <h3><i class="fas fa-calculator"></i> 总体评估</h3>
            <div class="summary-grid">
                <div class="summary-card">
                    <h4>总分</h4>
                    <div class="score" id="totalScore">0</div>
                    <div class="desc">90个项目总分</div>
                </div>
                <div class="summary-card">
                    <h4>总均分</h4>
                    <div class="score" id="totalAvg">0.00</div>
                    <div class="desc">总分÷90</div>
                </div>
                <div class="summary-card">
                    <h4>阳性项目数</h4>
                    <div class="score" id="positiveCount">0</div>
                    <div class="desc">得分≥2的项目数</div>
                </div>
                <div class="summary-card">
                    <h4>阳性症状均分</h4>
                    <div class="score" id="positiveAvg">0.00</div>
                    <div class="desc">阳性项目总分÷阳性项目数</div>
                </div>
            </div>
        </div>

        <div class="dimensions-section">
            <h3><i class="fas fa-brain"></i> 各维度详细分析</h3>
            <div id="dimensionsList"></div>
        </div>

        <div class="interpretation">
            <h3><i class="fas fa-info-circle"></i> 结果解读与建议</h3>
            <div id="interpretationContent"></div>
            <div class="warning-box">
                <p><i class="fas fa-exclamation-triangle"></i> <strong>重要提醒：</strong>本测评结果仅供参考，不能作为医学诊断依据。如有需要，请咨询专业心理医生或到正规医疗机构就诊。</p>
            </div>
        </div>

        <div class="actions">
            <a href="scl90.html" class="btn btn-secondary"><i class="fas fa-redo"></i> 重新测评</a>
            <button class="btn btn-primary" onclick="window.print()"><i class="fas fa-print"></i> 打印报告</button>
            <a href="index.html" class="btn btn-secondary"><i class="fas fa-home"></i> 返回首页</a>
        </div>
    </div>

    <script>
        // 获取测评结果
        const urlData = new URLSearchParams(location.search).get('d');
if (!urlData) {                  // 没拿到就跳回去
    alert('未找到测评数据，请先完成测评！');
    location.href = 'scl90.html';
}
const results = JSON.parse(decodeURIComponent(urlData));

        // 显示测评时间
        document.getElementById('testTime').textContent = new Date(results.timestamp).toLocaleString('zh-CN');

        // 计算总体指标
        const totalScore = results.totalScore;
        const totalAvg = parseFloat(results.totalAvg);
        const positiveItems = Object.values(results.scores).filter(score => score >= 2);
        const positiveCount = positiveItems.length;
        const positiveAvg = positiveCount > 0 ? (positiveItems.reduce((a, b) => a + b, 0) / positiveCount).toFixed(2) : '0.00';

        // 显示总体指标
        document.getElementById('totalScore').textContent = totalScore;
        document.getElementById('totalAvg').textContent = totalAvg;
        document.getElementById('positiveCount').textContent = positiveCount;
        document.getElementById('positiveAvg').textContent = positiveAvg;

        // 维度解释和建议
        const dimensionInfo = {
            '躯体化': {
                desc: '反映身体不适感，包括心血管、胃肠道、呼吸等系统的不适',
                advice: {
                    normal: '躯体症状轻微，建议保持规律作息和适度运动',
                    mild: '存在轻度躯体不适，建议关注身体健康，必要时体检',
                    moderate: '躯体症状明显，建议就医检查排除器质性疾病',
                    severe: '躯体症状严重，强烈建议立即就医全面检查'
                }
            },
            '强迫症状': {
                desc: '反映强迫思维和行为，如反复检查、计数、洗涤等',
                advice: {
                    normal: '强迫倾向轻微，属于正常范围',
                    mild: '有轻度强迫倾向，建议放松心情，避免过度追求完美',
                    moderate: '强迫症状明显，影响日常生活，建议寻求心理咨询',
                    severe: '强迫症状严重，建议尽快寻求专业心理治疗'
                }
            },
            '人际关系敏感': {
                desc: '反映人际关系中的不自在感和自卑感',
                advice: {
                    normal: '人际关系良好，保持积极的社交活动',
                    mild: '在人际交往中略显敏感，建议增强自信',
                    moderate: '人际关系敏感明显，建议学习社交技巧，必要时寻求咨询',
                    severe: '人际关系严重敏感，建议寻求专业心理咨询'
                }
            },
            '抑郁': {
                desc: '反映抑郁情绪，如兴趣减退、缺乏活力、悲观等',
                advice: {
                    normal: '情绪状态良好，保持积极心态',
                    mild: '有轻度抑郁情绪，建议增加户外活动，与朋友交流',
                    moderate: '抑郁情绪明显，建议寻求心理咨询，考虑专业帮助',
                    severe: '抑郁症状严重，强烈建议立即寻求专业心理帮助'
                }
            },
            '焦虑': {
                desc: '反映焦虑情绪，如紧张、担忧、害怕等',
                advice: {
                    normal: '焦虑水平正常，保持放松的心态',
                    mild: '有轻度焦虑，建议学习放松技巧，如深呼吸',
                    moderate: '焦虑症状明显，建议寻求心理咨询，学习应对策略',
                    severe: '焦虑症状严重，建议尽快寻求专业心理治疗'
                }
            },
            '敌对': {
                desc: '反映敌对情绪，如易怒、争论、摔物等',
                advice: {
                    normal: '情绪控制良好，保持平和心态',
                    mild: '有轻度敌对情绪，建议学习情绪管理技巧',
                    moderate: '敌对情绪明显，建议寻求心理咨询，学习冲突解决',
                    severe: '敌对症状严重，建议立即寻求专业心理帮助'
                }
            },
            '恐怖': {
                desc: '反映恐怖情绪和回避行为，如恐高、恐乘交通工具等',
                advice: {
                    normal: '恐怖症状轻微，属于正常范围',
                    mild: '有轻度恐怖症状，建议逐步暴露疗法',
                    moderate: '恐怖症状明显，影响日常生活，建议寻求心理咨询',
                    severe: '恐怖症状严重，建议尽快寻求专业心理治疗'
                }
            },
            '偏执': {
                desc: '反映偏执思维和猜疑，如不信任他人、感到被监视等',
                advice: {
                    normal: '信任他人，保持开放心态',
                    mild: '有轻度偏执倾向，建议增强对他人的信任',
                    moderate: '偏执症状明显，建议寻求心理咨询，改善认知',
                    severe: '偏执症状严重，建议立即寻求专业心理帮助'
                }
            },
            '精神病性': {
                desc: '反映精神病性症状，如幻听、被控制感等',
                advice: {
                    normal: '精神健康状况良好',
                    mild: '有轻微精神病性症状，建议关注心理健康',
                    moderate: '精神病性症状明显，强烈建议寻求专业评估',
                    severe: '精神病性症状严重，必须立即就医'
                }
            }
        };

        // 生成维度分析
        function getLevel(avg) {
            if (avg < 1) return 'normal';
            if (avg < 2) return 'mild';
            if (avg < 3) return 'moderate';
            return 'severe';
        }

        function getLevelText(level) {
            const levels = {
                'normal': '正常范围',
                'mild': '轻度',
                'moderate': '中度',
                'severe': '重度'
            };
            return levels[level];
        }

        function getLevelColor(level) {
            const colors = {
                'normal': '#4CAF50',
                'mild': '#FF9800',
                'moderate': '#FF5722',
                'severe': '#F44336'
            };
            return colors[level];
        }

        // 渲染维度列表
        const dimensionsList = document.getElementById('dimensionsList');
        let interpretationHTML = '';

        for (let dim in results.dimensions) {
            const data = results.dimensions[dim];
            const level = getLevel(data.avg);
            const levelText = getLevelText(level);
            const color = getLevelColor(level);
            const info = dimensionInfo[dim];

            const dimHTML = `
                <div class="dimension-item">
                    <div class="dimension-header">
                        <span class="dimension-name">${dim}</span>
                        <span class="dimension-score">${data.total}分 (${data.avg})</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill" style="width: ${(data.avg / 4) * 100}%; background-color: ${color};"></div>
                    </div>
                    <div class="dimension-desc">
                        <strong>状态：</strong>${levelText} | ${info.desc}
                    </div>
                </div>
            `;
            dimensionsList.innerHTML += dimHTML;

            // 构建解读内容
            interpretationHTML += `
                <p><strong>${dim}（${levelText}）：</strong>${info.advice[level]}</p>
            `;
        }

        document.getElementById('interpretationContent').innerHTML = interpretationHTML;

        // 总体建议
        const overallLevel = getLevel(totalAvg);
        let overallAdvice = '';
        
        switch (overallLevel) {
            case 'normal':
                overallAdvice = '您的心理健康状况良好，请继续保持积极的生活态度和健康的生活方式。';
                break;
            case 'mild':
                overallAdvice = '您的心理健康状况基本正常，但存在轻度压力反应。建议适当调整生活节奏，增加放松活动。';
                break;
            case 'moderate':
                overallAdvice = '您可能存在中度心理问题，建议寻求专业心理咨询师的帮助，及时获得支持和指导。';
                break;
            case 'severe':
                overallAdvice = '您的心理健康状况需要重视，强烈建议尽快寻求专业心理医生或精神科医生的帮助。';
                break;
        }

        interpretationHTML = `<p><strong>总体评估：</strong>${overallAdvice}</p>` + interpretationHTML;
        document.getElementById('interpretationContent').innerHTML = interpretationHTML;
    </script>
</body>
</html>